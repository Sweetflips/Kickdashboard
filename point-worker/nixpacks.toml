# Point Worker - Nixpacks/Railpack configuration
# Root directory: /point-worker
# Uses parent directory for source files

providers = ["node"]

[phases.setup]
# Remove cacert - it conflicts with the one nodejs brings in
nixPkgs = ["nodejs_22", "npm-10_x", "openssl"]

[phases.install]
# Install deps from parent directory where package.json lives
cmds = [
  "cd .. && npm ci",
  "cd .. && npx prisma generate"
]

# No Next.js build needed for worker
[phases.build]
cmds = ["echo 'âš¡ Worker mode - no build needed'"]

[start]
# Start worker from parent directory
cmd = "cd .. && node scripts/start-worker.js"
